<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Birthday Surprise â€” Ash25</title>

<!-- canvas-confetti CDN -->
<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

<style>
  :root{
    --bg1: #ffefe9;
    --bg2: #e6f7ff;
    --accent: #ff4fa1;
    --muted: #475569;
  }
  html,body{height:100%;margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto; -webkit-font-smoothing:antialiased}
  body{
    display:flex;align-items:center;justify-content:center;
    background:linear-gradient(135deg,var(--bg1),var(--bg2));
    padding:18px;
  }
  .card{
    width:100%;max-width:760px;background:linear-gradient(180deg,#ffffffcc,#ffffff);border-radius:16px;padding:20px;
    box-shadow:0 18px 40px rgba(20,30,60,0.12);text-align:center;
  }
  h1{margin:6px 0 8px;font-size:20px;color:#0f1724}
  p.lead{margin:0 0 14px;color:var(--muted)}
  input[type="text"]{
    width:86%;max-width:420px;padding:12px 14px;border-radius:10px;border:1px solid #e6e9ef;font-size:17px;
    outline:none;box-shadow:inset 0 -2px 0 rgba(0,0,0,0.03);
  }
  button.primary{
    margin-top:12px;padding:12px 18px;border-radius:12px;border:0;background:linear-gradient(90deg,var(--accent),#7c4dff);
    color:white;font-weight:600;font-size:16px;box-shadow:0 8px 20px rgba(124,77,255,0.18);
  }
  button.secondary{
    margin-top:12px;padding:10px 14px;border-radius:10px;border:0;background:#fff;font-weight:600;font-size:15px;color:#374151;
    box-shadow:0 6px 14px rgba(0,0,0,0.06);
  }
  #msg{margin-top:20px;opacity:0;transform:translateY(6px);transition:all .5s ease;text-align:center}
  #msg.show{opacity:1;transform:translateY(0)}
  #msg h2{margin:6px 0 4px;font-size:26px}
  #msg p{margin:0;color:#334155}

  /* full-screen confetti canvas */
  #confetti-canvas{position:fixed;left:0;top:0;pointer-events:none;width:100%;height:100%;z-index:9999}
  footer{margin-top:16px;color:#94a3b8;font-size:13px}
  @media (max-width:420px){
    input[type="text"]{width:100%}
  }
</style>
</head>
<body>
  <div class="card" role="main" aria-labelledby="title">
    <h1 id="title">A secret surprise â€” enter the code</h1>
    <p class="lead">Type the secret code and tap <strong>Unlock</strong>. Hold phone naturally.</p>

    <input id="codeInput" type="text" inputmode="text" autocomplete="off" placeholder="Enter secret code (e.g. Ash25)">
    <br>
    <button class="primary" id="unlockBtn">Unlock</button>

    <div id="msg" aria-live="polite" role="status">
      <h2 id="msgTitle">ðŸŽ‰ HAPPY BIRTHDAY â€” Ash! ðŸŽ‰</h2>
      <p id="msgBody">Wishing you a day filled with love, laughter and all your favourite things.</p>
      <div style="margin-top:12px">
        <button id="playBtn" class="secondary" style="display:none">ðŸŽµ Tap to play song</button>
      </div>
    </div>

    <footer>Secret code: <strong>Ash25</strong> (you provided this)</footer>
  </div>

  <!-- confetti canvas -->
  <canvas id="confetti-canvas"></canvas>

<script>
/* -------- CONFIG -------- */
const SECRET = "Ash25"; // exact match (case-sensitive). Change if you want case-insensitive.
/* ------------------------ */

const unlockBtn = document.getElementById('unlockBtn');
const codeInput = document.getElementById('codeInput');
const msg = document.getElementById('msg');
const msgTitle = document.getElementById('msgTitle');
const msgBody = document.getElementById('msgBody');
const playBtn = document.getElementById('playBtn');

const canvas = document.getElementById('confetti-canvas');
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

window.addEventListener('resize', ()=> {
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
});

// create Audio when needed (after gesture)
let music = null;
const AUDIO_URL = "https://docs.google.com/uc?export=download&id=1b_vxT_4l4fxdTXSQQW4mxh3mfIDky7RT";

/* -------- Canvas-Confetti wrapper using CDN library -------- */
function fireRandomBurst(){
  // random origin to spread confetti well across screen
  confetti({
    particleCount: 30,
    startVelocity: 25,
    spread: 60,
    ticks: 120,
    origin: { x: Math.random(), y: Math.random() * 0.3 }
  });
}

let confettiInterval = null;
function startContinuousConfetti(){
  if(confettiInterval) return;
  // initial burst
  fireRandomBurst();
  // continuous small bursts
  confettiInterval = setInterval(fireRandomBurst, 300); // every 300ms
}
function stopContinuousConfetti(){
  if(confettiInterval){ clearInterval(confettiInterval); confettiInterval = null; }
}

/* -------- Unlock logic -------- */
unlockBtn.addEventListener('click', async () => {
  const val = codeInput.value.trim();
  if(!val){
    alert("Please enter the secret code.");
    return;
  }

  // check code exactly (case-sensitive). If you want case-insensitive:
  // if(val.toLowerCase() === SECRET.toLowerCase())
  if(val === SECRET){
    // reveal message and start confetti
    msg.classList.add('show');
    startContinuousConfetti();

    // create Audio object now (in user gesture)
    if(!music){
      try{
        music = new Audio(AUDIO_URL);
        music.loop = false;
      }catch(e){
        console.warn("Audio creation failed", e);
      }
    }

    // attempt to play immediately (this click is a user gesture)
    if(music){
      music.play().then(()=> {
        // success: hide play button if visible
        playBtn.style.display = 'none';
      }).catch(()=> {
        // blocked â€” show "Tap to play" button for user to allow sound
        playBtn.style.display = 'inline-block';
      });
    } else {
      // if audio couldn't be created, show play button as fallback
      playBtn.style.display = 'inline-block';
    }

    // small haptic feedback if supported (mobile)
    if(navigator.vibrate) navigator.vibrate(60);
    // optionally disable the unlock button to prevent re-trigger
    unlockBtn.disabled = true;
    unlockBtn.style.opacity = 0.6;
    codeInput.disabled = true;
  } else {
    // wrong code feedback
    alert("Wrong code â€” try again!");
    // small shake/vibrate
    if(navigator.vibrate) navigator.vibrate([40,20,40]);
  }
});

// Play button fallback (single tap will start audio)
playBtn.addEventListener('click', ()=>{
  if(!music) music = new Audio(AUDIO_URL);
  music.play().catch(()=> {
    alert("Audio blocked â€” try tapping anywhere on the screen once and then press this button again.");
  });
});

/* Optional: allow Enter key to submit on virtual keyboard */
codeInput.addEventListener('keydown', (e)=>{
  if(e.key === 'Enter'){
    unlockBtn.click();
  }
});
</script>
</body>
</html>
